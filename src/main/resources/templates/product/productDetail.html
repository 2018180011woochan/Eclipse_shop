<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layout}">
<head>
    <meta charset="UTF-8">
    <title>상품 상세</title>

	<link rel="stylesheet" href="/common/css/bootstrap.min.css">
</head>
<body>
<main layout:fragment="content">
<div class="container mt-5">
    <div class="row">
        <!-- 왼쪽: 이미지 영역 -->
        <div class="col-md-6">
            <!-- Carousel -->
            <div id="productImageCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <!-- 여러 장의 이미지가 product.images라는 List에 들어있다고 가정 -->
                    <!-- 첫 번째 이미지는 .active 클래스를 추가해줘야 보임 -->
					<div th:each="img, stat : ${product.images}"
					     th:classappend="${stat.index == 0} ? 'carousel-item active' : 'carousel-item'">
					    <img th:src="@{${img.imageUrl}}" class="d-block w-100" style="max-height: 500px; object-fit: cover;" alt="상품 이미지">
					</div>
                    <!-- 만약 images가 비어있다면, 썸네일만 표시 (백업 용) -->
                    <div th:if="${product.images == null or product.images.size() == 0}" class="carousel-item active">
                        <img th:src="@{${product.thumbnailUrl}}"
                             class="d-block w-100" style="max-height: 500px; object-fit: cover;" alt="상품 이미지">
                    </div>
                </div>

                <!-- 좌측 화살표(이전) -->
                <button class="carousel-control-prev" type="button" data-bs-target="#productImageCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">이전</span>
                </button>
                <!-- 우측 화살표(다음) -->
                <button class="carousel-control-next" type="button" data-bs-target="#productImageCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">다음</span>
                </button>
            </div>
        </div>
        <!-- 오른쪽: 상품 정보 -->
        <div class="col-md-6" id="productContainer" th:data-product-id="${product.productId}">
            <h2 th:text="${product.name}">상품 이름</h2>
            <h4 th:text="'₩ ' + ${product.price}">₩ 10000</h4>
            <p th:text="${product.description}">상품 설명</p>

            <!-- 옵션이 있는 경우 예시 -->
            <div th:if="${product.options != null}">
                <label>옵션 선택</label>
                <select class="form-select" id="optionSelect" name="optionId" th:if="${product.options != null}">
				    <option value="">옵션을 선택하세요</option>
				    <option th:each="opt : ${product.options}"
				            th:value="${opt.optionId}"
				            th:text="${opt.color + ' / ' + opt.size + ' / 재고:' + opt.stockQuantity}">
				    </option>
				</select>
            </div>
			<div id="selectedOptionsContainer" class="mt-3"></div>
            <button id="addToCartBtn" class="btn btn-primary mt-3">장바구니에 담기</button>
            <button id="inquiryBtn" class="btn btn-primary mt-3">문의 목록</button>
            <button id="reviewBtn" class="btn btn-primary mt-3">리뷰 목록</button>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/product/js/productDetail.js"></script>
</main>
</body>
</html>
